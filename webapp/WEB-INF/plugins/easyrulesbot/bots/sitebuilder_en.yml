## Site builder bot 
--- 
name: Site Builder (YAML)
key: sitebuilder
description: Bot for creating a site builder
language: en
welcomeMessage: Hello !
avatarUrl: images/skin/plugins/easyrulesbot/modules/sitebuilder/sitebuilder-avatar.png
standalone: false

filters:
    -   filter: DEBUG
    -   filter: INSULT
    -   filter: THANK
    -   filter: LAUGH

rules:
    -   rule: Greetings
        description: Greets the user and ask him his name
        priority: 0
        message: Hello, what's your name ?
        dataKey: user_firstname
        processor: INPUT_STRING
        conditions:
        -   condition: DATAKEY_MISSING
        responseComment: Hello {user_firstname} ! I will help you build your website LUTECE.

    -   rule: Mylutece
        description: Ask the user about the authentication of the site
        priority: 10
        message: Do you want all or only part of the site to be authenticated?
        dataKey: mylutece
        processor: YES_NO
        conditions:
        -   condition: DATAKEY_MISSING
        responseComment: "<#if mylutece='true'>We will now choose the type of authentication.</#if>"
  
    -   rule: MyLuteceModule
        priority: 11
        message: Here are the possible choices
        buttons:
        -   title: OpenAM
            value: openam
        -   title: CAS
            value: cas
        -   title: Call me
            value: 0606060606
            type: phonenumber
        dataKey: mylutecemodule
        processor: MYLUTECE_MODULE
        conditions:
        -   condition: DATAKEY_MISSING
        -   condition: DATAKEY_VALUE
            parameters: 
            - mylutece
            - true
        responseComment: Good choice
    
    -   rule: SendMail
        priority: 90
        description: Ask the user if he wants a mailing
        message: Would you like to receive the pom.xml file by mail?
        dataKey: sendbymail
        processor: YES_NO
        conditions:
        -   condition: DATAKEY_MISSING
        
    -   rule: GetEmail
        priority: 91
        description: Request the user's email
        message: What is your email address ?
        dataKey: user_email
        processor: INPUT_EMAIL
        conditions:
        -   condition: DATAKEY_VALUE
            parameters: [ sendbymail , true ]

    -   rule: BuildSendPom
        priority: 92
        description: Build and send POM file
        message: Are you ready to receive the file
        dataKey: done
        processor: BUILD_AND_SEND_POM
        conditions:
        -   condition: DATAKEY_MISSING
        -   condition: DATAKEY_VALUE
            parameters: [ sendbymail , true ]
        responseComment: I sent you the pom by mail!
        
    -   rule: Finalize
        priority: 99
        description: End of the session
        message: We finished. Do you want to start a session again?
        dataKey: restart
        buttons:
        -   title: Oui
            value: reset
        -   title: Non
            value: no
        processor: YES_NO
        conditions:
        -   condition: DATAKEY_MISSING
        responseComment: Goodbye and see you soon !
        
  
